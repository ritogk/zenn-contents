---
title: "åœ°å›³ã‹ã‚‰ã“ã ã‚ã‚Šã®é“ã‚’æŠ½å‡ºã™ã‚‹æ–¹æ³•"
emoji: "ğŸ—ºï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Python", "gis", "openstreetmap", "networkx", "GeoPandas"]
published: false
---

# æƒ³å®šã™ã‚‹èª­è€…

ã“ã®è¨˜äº‹ã§ã¯ã€ç„¡æ–™ã®åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã“ã ã‚ã‚Šã®é“ã‚’æŠ½å‡ºã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
ã“ã‚Œã¯ã€åœ°ç†ç©ºé–“æƒ…å ±ã®åˆå¿ƒè€…ã®ç§ãŒã“ã ã‚ã‚Šã®é“ã‚’æ¢ã—ãŸæ™‚ã®æ–¹æ³•ã§ã™ã€‚
ç§è‡ªèº«ä½•ã‹ã‚‰è§¦ã‚Œã°ã„ã„ã®ã‹åˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€åŒã˜å¢ƒé‡ã®äººã®å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

# ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿

åœ°å›³ãƒ‡ãƒ¼ã‚¿ã«ã¯ç„¡æ–™ã®OSM(OpenStreetMap)ã‚’ä½¿ã„ã¾ã™ã€‚
OSMå†…ã«ã¯è»Šé“ã€æ­©é“ã€å±±ã€å·ã€åº—èˆ—ç­‰ãŒå«ã¾ã‚Œã¦ã„ã¦ã€ã“ã‚Œã‚‰ã‚’ä½¿ã£ã¦ç›®çš„ã®é“ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
https://openstreetmap.jp/
OSMã¯ãƒã‚±ãƒ¢ãƒ³GOã‚„Teslaã®ã‚«ãƒ¼ãƒŠãƒ“ã«ã‚‚ä½¿ã‚ã‚Œã¦ã„ãŸã‚Šã—ã¾ã™ã€‚

# æŠ½å‡ºãƒ—ãƒ­ã‚»ã‚¹

å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã™å‰ã«ã€ã–ã£ãã‚Šã¨æŠ½å‡ºãƒ—ãƒ­ã‚»ã‚¹ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
å‡¦ç†ã‚’å˜ç´”åŒ–ã™ã‚‹ãŸã‚ã«2æ®µæ§‹æˆã«ãªã£ã¦ã„ã¾ã™ã€‚

## å€™è£œã‚’æŠ½å‡º

OSMã«ã¯è†¨å¤§ãªãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã€ä¸€æ°—ã«ã™ã¹ã¦ã®äº‹ã‚’è¡Œã†ã¨ã™ã‚‹ã¨å¤§å¤‰ã§ã™ã€‚
ãªã®ã§ã€ã¾ãšã‚†ã‚‹ã„æ¡ä»¶ã§çµã‚Šè¾¼ã¿ã€ç›®çš„ã®é“ã®å€™è£œã‚’æŠ½å‡ºã—ã¾ã™ã€‚

| çµã‚Šè¾¼ã¿ãªã—                                  | çµã‚Šè¾¼ã¿ã‚ã‚Š                                  |
| --------------------------------------------- | --------------------------------------------- |
| ![çµã‚Šè¾¼ã¿ãªã—](/images/f9a314841c737d/1.png) | ![çµã‚Šè¾¼ã¿ã‚ã‚Š](/images/f9a314841c737d/2.png) |

ã“ã®çµã‚Šè¾¼ã‚“ã ã‚¨ãƒƒã‚¸ï¼ˆç‚¹ã¨ç‚¹ã®é–“ã®ãƒ©ã‚¤ãƒ³ï¼‰ãŒå€™è£œã¨ãªã‚Šã¾ã™ã€‚
ã‚¨ãƒƒã‚¸ã¯ç‰¹å®šåŒºé–“ã®é“ã®ã‚ˆã†ãªç‰©ã§ã™ã€‚
![ã‚¨ãƒƒã‚¸ã®ä¸€è¦§](/images/f9a314841c737d/3.png =500x)

## ç‰¹å¾´ã‚’è©•ä¾¡ã—ã¦çµã‚Šè¾¼ã‚€

ã•ãã»ã©ã®ã‚¨ãƒƒã‚¸ä½¿ã£ã¦ã•ã‚‰ã«çµã‚Šè¾¼ã¿ã‚’è¡Œã„ã¾ã™ã€‚
ã‚¨ãƒƒã‚¸ã¯è¤‡æ•°ã®ç‚¹ï¼ˆç·¯åº¦ã€çµŒåº¦ï¼‰ã®é›†ã¾ã‚Šã‹ã‚‰ã§ãã¦ã„ã¾ã™ã€‚
![](/images/f9a314841c737d/4.png =500x)

ã“ã®ç‚¹ã‚’ä½¿ã£ã¦ã‚¨ãƒƒã‚¸ã‚’è©•ä¾¡ã—ã¾ã™ã€‚
è©•ä¾¡å€¤ã®ä¸Šä½æ•°ä»¶ãŒ`ã“ã ã‚ã‚Šã®é“`ã¨ãªã‚Šãªã‚Šã¾ã™ã€‚
![](/images/f9a314841c737d/5.png =500x)
![](/images/f9a314841c737d/6.png =500x)

# æ‰‹ã‚’å‹•ã‹ã—ã¦å®Ÿè£…ã™ã‚‹

ã“ã ã‚ã‚Šã®é“ã‚’ã€Œã‚‰ãã—ã¦é‹è»¢ã§ãã‚‹é“ã€ã¨ã—ã€æŠ½å‡ºã§ãã‚‹ã¾ã§ã‚’ã‚´ãƒ¼ãƒ«ã¨ã—ã¾ã™ã€‚
ã‚‰ãã—ã¦é‹è»¢ã§ãã‚‹é“ã®ç‰¹å¾´ã¯ã“ã‚“ãªæ„Ÿã˜ã«ã—ã¾ã—ãŸã€‚

- ä¸€èˆ¬é“
- è»Šç·šãŒ2è»Šç·šä»¥ä¸Š
- 800mä»¥ä¸Šã®åŒºé–“
- åˆ†å²ãŒå°‘ãªã„é“
- ç›´ç·šçš„ãªé“

## å‹•ä½œç’°å¢ƒ

Ubuntu 22.04
Python 3.11.6
Jupyter Notebook

## **åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹**

æƒ…å ±é‡ãŒå¤šã™ãã‚‹ã¨ã€è€ƒãˆã‚‹äº‹ãŒå¤šããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
ãªã®ã§ã€Œæ¥½ã—ã¦é‹è»¢ã§ãã‚‹é“ã€ãŒå«ã¾ã‚Œã‚‹3~5kmã®ç¯„å›²ã®åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦èª¿æŸ»ã‚’è¡Œã„ã¾ã™ã€‚

åœ°å›³ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«ã¯[OSMnx](https://osmnx.readthedocs.io/en/stable/)ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã„ã¾ã—ãŸã€‚
ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯OSMã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã€è§£æã€è¦–è¦šåŒ–ã‚’ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

OSMã®é“ã«ã¯[é“è·¯ç¨®åˆ¥](https://wiki.openstreetmap.org/wiki/JA:Key:highway)ã¨[è»Šç·šã®æ•°](https://wiki.openstreetmap.org/wiki/JA:Key:lanes)ã®æƒ…å ±ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚
![](/images/f9a314841c737d/7.png =500x)

OSMnxã¯æ¡ä»¶ã‚’æŒ‡å®šã—ã¦OSMã®åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹ã®ã§ã€Œ`ä¸€èˆ¬é“`ã€ã¨ã€Œ`ï¼’è»Šç·šä»¥ä¸Šã®é“`ã€ã‚’æŠ½å‡ºæ¡ä»¶ã«å«ã¾ã›ã¦ã€ã“ã“ã§ç¢ºå®šã•ã›ã¾ã™ã€‚

```python
import osmnx as ox
import networkx as nx
latitude = 35.336452
longitude = 136.922696
dist = 5000
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ã†
ox.config(use_cache=True, log_console=True)
# 5kmä»¥å†…ã®é“è·¯ã‚’å–å¾—ã™ã‚‹
graph = ox.graph_from_point(center_point=(latitude,longitude),
                            network_type='drive',
                           simplify=True,
                           retain_all=True,
                           dist=dist,
                           custom_filter='["highway"~"secondary|secondary_link|primary|primary_link|trunk|trunk_link"]["lanes"=2]')
graph2 = ox.graph_from_point(center_point=(latitude,longitude),
                            network_type='drive',
                           simplify=True,
                           retain_all=True,
                           dist=dist,
                           custom_filter='["highway"~"tertiary"]')
# highway:tertiaryã¯2è»Šç·šã‚’è¡¨ã™ã®ã§lanesã®æŠ½å‡ºã¯ä¸è¦ã€‚
# ãã®ä»–ã®é“ã¯2è»Šç·šã‚’è¡¨ã™ã‚¿ã‚°ãŒã¤ã„ã¦ã„ã‚‹é“ã®ã¿ã‚’æŠ½å‡ºã™ã‚‹ã€‚
# highway: unclassifiedã¯ç‹­ã„é“ãªã®ã§å«ã‚ãªã„ã€‚
# è¤‡é›‘ãªcustom_filteræŒ‡å®šæ–¹æ³•ãŒåˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€æŠ½å‡ºå‡¦ç†ã‚’åˆ†å‰²ã—ã¦çµåˆã—ã¦ã¾ã™ã€‚
graph = nx.compose(graph, graph2)
# JupyterNotebookä¸Šã«åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹
map = ox.plot_graph_folium(graph, edge_width=2)
map
```

![](/images/f9a314841c737d/8.png =500x)

## 800mä»¥ä¸‹ã®é“ã‚’å–ã‚Šé™¤ã

çŸ­ã™ãã‚‹ã‚¨ãƒƒã‚¸ã«ä¾¡å€¤ã¯ãªã„ã®ã§ã“ã“ã§å–ã‚Šé™¤ãã¾ã™ã€‚
Osmnxã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯graphå½¢å¼ã§ã™ã€‚
ã“ã®å½¢å¼ã¯ã‚¨ãƒƒã‚¸å˜ä½“ã§ã®åˆ†æã«ã¯é©ã—ã¦ã„ã¾ã›ã‚“ã€‚
ã“ã‚Œã‚’GeoDataFrameå½¢å¼ã«å¤‰æ›ã™ã‚‹ã¨ã€ã‚¨ãƒƒã‚¸æ¯ã®è§£æãŒã¨ã¦ã‚‚è¡Œã„ã‚„ã™ããªã‚Šã¾ã™ã€‚

```python
# graphã‹ã‚‰GeoDataFrameã«å¤‰æ›
gdf_edges = ox.graph_to_gdfs(graph, nodes=False, edges=True)
# 800mä»¥ä¸‹ã®é“ã‚’å–ã‚Šé™¤ã
gdf_edges = gdf_edges[gdf_edges["length"] >= 800]
```

ã“ã“ã§ã¯lengthã‚’æŒ‡å®šã—ã¾ã—ãŸãŒã€ä»–ã«ã‚‚[è‰²ã€…ãªã‚¿ã‚°](https://www.okuminavi.jp/access/pdf/OSM_taguitiran.pdf)ãŒã‚ã£ãŸã‚Šã—ã¾ã™ã€‚

## é€†æ–¹å‘ã®é“ã‚’å–ã‚Šé™¤ã

æŠ½å‡ºã—ãŸã‚¨ãƒƒã‚¸ã«ã¯ã€ä¸€æ–¹é€šè¡Œã®é“ã‚’é™¤ãã€é€²è¡Œæ–¹å‘ã¨é€†æ–¹å‘ã®2ã¤ã®ã‚¨ãƒƒã‚¸ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
ä»Šå›ã¯ç‰‡å´ã ã‘ã§ã‚ˆã„ã®ã§å–ã‚Šé™¤ãã¾ã™ã€‚
![](/images/f9a314841c737d/9.png =500x)

```python
# é€†æ–¹å‘ã®ã‚¨ãƒƒã‚¸ã‚’å‰Šé™¤ã™ã‚‹
drop_target = []
for index, row in gdf_edges.iterrows():
    if (index[1], index[0], 0) in drop_target:
        continue
    if (index[0], index[1], 0) in drop_target:
        continue
    drop_target.append(index)
gdf_edges = gdf_edges[gdf_edges.index.isin(drop_target)]
```

## **åˆ†å²ãŒå°‘ãªã„é“ã‚’è©•ä¾¡ã™ã‚‹é–¢æ•°**

ã•ãã»ã©æŠ½å‡ºã—ãŸã‚¨ãƒƒã‚¸ã«ã¯ã€ã‚¨ãƒƒã‚¸ã‹ã‚‰åˆ†å²ã™ã‚‹é“ã®æƒ…å ±ã‚’æŒã£ã¦ã„ã¾ã›ã‚“ã€‚
ãã®ãŸã‚ã€ã‚¨ãƒƒã‚¸ã‚’æ§‹æˆã™ã‚‹ç‚¹ã®åº§æ¨™ã¨ä¸€è‡´ã™ã‚‹ãƒãƒ¼ãƒ‰ã‚’æ¢ã—ã¦ã€åˆ†å²æ•°ã‚’è¨ˆç®—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ç›´å‰ã§å–å¾—ã—ãŸåœ°å›³ãƒ‡ãƒ¼ã‚¿ã«ã¯ã€å¿…è¦æœ€ä½é™ã®æƒ…å ±ã—ã‹å«ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚
ãªã®ã§ã€OSmnxã§ã™ã¹ã¦ã®é“ã‚’å–å¾—ã—ã€ãã®é“ã¨ã‚¨ãƒƒã‚¸ã‚’æ¯”è¼ƒã—ã¦åˆ†å²æ•°ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

```python
# çµã‚Šè¾¼ã¿ãªã—ã§åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹
graph_all = ox.graph_from_point(center_point=(latitude,longitude),
                            network_type='drive',
                            simplify=True,
                            retain_all=True,
                            dist=5000)
# ãƒãƒ¼ãƒ‰ã‚’å–ã‚Šå‡ºã™ã€‚
all_nodes = ox.graph_to_gdfs(graph_all, nodes=True, edges=False)
# ã‚¨ãƒƒã‚¸ã®åˆ†å²æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã€‚
gdf_edges['branch_cnt'] = 0
for index, row in gdf_edges.iterrows():
  nodes = all_nodes[all_nodes.geometry.intersects(row.geometry)]
  # åˆ†å²æ•°ã‚’è¨ˆç®—
  gdf_edges.at[index, 'branch_cnt'] = nodes['street_count'].sum() - (len(nodes) * 2)
```

è·é›¢ã¨åˆ†å²æ•°ã®æ¯”ç‡ã‚’æ±‚ã‚ã¦ã€ã“ã®å€¤ã‚’`åˆ†å²ãŒå°‘ãªã„é“`ã®è©•ä¾¡å€¤ã¨ã—ã¾ã™ã€‚

```python
gdf_edges['branch_cnt_to_length_rate'] = 1 - (gdf_edges['branch_cnt'] / gdf_edges['length'])
```

## **ç›´ç·šçš„ãªé“ã‚’è©•ä¾¡ã™ã‚‹é–¢æ•°**

ã‚¨ãƒƒã‚¸ã«ã¯å½¢ã‚’æ§‹æˆã™ã‚‹åº§æ¨™ã‚’æŒã£ã¦ã„ã¾ã™ã€‚
ã“ã®åº§æ¨™é–“ã®è§’åº¦ã®åˆè¨ˆã‚’æ±‚ã‚ã€ã‚¨ãƒƒã‚¸ãŒæ¹¾æ›²ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤åˆ¥ã—ã¾ã™ã€‚
![](/images/f9a314841c737d/10.png =500x)

```python
# 3åº§æ¨™é–“ã®è§’åº¦ã‚’è¨ˆç®—
def calculate_angle_between_vectors(A, B, C):
    vector_AB = np.array(B) - np.array(A)
    vector_BC = np.array(C) - np.array(B)

    dot_product = np.dot(vector_AB, vector_BC)
    norm_AB = np.linalg.norm(vector_AB)
    norm_BC = np.linalg.norm(vector_BC)

    cosine_theta = dot_product / (norm_AB * norm_BC)
    angle_rad = np.arccos(cosine_theta)
    angle_deg = np.degrees(angle_rad)
    return angle_deg

# åº§æ¨™é–“ã®è§’åº¦ã®å¤‰åŒ–ã®åˆè¨ˆå€¤ã‚’æ±‚ã‚ã‚‹
gdf_edges['geometory_angle_total'] = gdf_edges['geometry'].apply(
    lambda x: sum([calculate_angle_between_vectors(x.coords[i-1], x.coords[i], x.coords[i+1]) for i in range(1, len(x.coords)-1)])
)
```

è·é›¢ã¨è§’åº¦ã®æ¯”ç‡ã‚’æ±‚ã‚ã¦ã€ã“ã®å€¤ã‚’`ç›´ç·šçš„ãªé“`ã®è©•ä¾¡å€¤ã¨ã—ã¾ã™ã€‚

```python
# è§’åº¦ã®åˆè¨ˆã¨è·é›¢ã®æ¯”ç‡ã‚’æ±‚ã‚ã‚‹
gdf_edges['geometory_angle_to_length_rate'] = 1 - (gdf_edges['geometory_angle_total'] / gdf_edges['length'])
```

ã‚ã¨ã¯ã€Œåˆ†å²æ•°ãŒå°‘ãªã„é“ã€ã¨ã€Œç›´ç·šçš„ãªé“ã€ã®è©•ä¾¡å€¤ã¨ã®ç©ã‚’æ±‚ã‚ã‚Œã°ã€Œã‚‰ãã—ã¦é‹è»¢ã§ãã‚‹é“ã€ã®è©•ä¾¡å€¤ãŒè¨ˆç®—ã§ãã¾ã™ã€‚

```python
# æ¥½ã—ã¦é‹è»¢ã§ãã‚‹é“ã®è©•ä¾¡å€¤
gdf_edges['score'] = gdf_edges['branch_cnt_to_length_rate'] * gdf_edges['geometory_angle_to_length_rate']
# 0~1ã®ç¯„å›²ã«æ­£è¦åŒ–
gdf_edges['score_normalized'] = gdf_edges['score'] / gdf_edges['score'].max()
# ä¸¦ã³æ›¿ãˆ
gdf_edges = gdf_edges.sort_values('score_normalized', ascending=False)
# ãƒ©ãƒ³ã‚­ãƒ³ã‚°
gdf_edges['rank'] = gdf_edges['score_normalized'].rank(ascending=False)

```

### ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ã«ç¢ºèªã™ã‚‹

æŠ½å‡ºã—ãŸå†…å®¹ã¯æ•°å€¤ãªã®ã§ã€ç›´æ„Ÿçš„ã«ç¢ºèªãŒã§ãã¾ã›ã‚“ã€‚
åœ°å›³ä¸Šã§ç¢ºèªã™ã‚‹ãŸã‚ã«Foliumã‚’ä½¿ã„ã€ä¸Šä½10ä»¶ã‚’å¼·èª¿ã—ã¦è¡¨ç¤ºã•ã›ã¾ã™ã€‚

```python
# GeoDataFrameã‹ã‚‰Graphå½¢å¼ã«å¤‰æ›
graph = ox.graph_from_gdfs(gdf_nodes, gdf_edges)
map_osm = ox.plot_graph_folium(graph, edge_width=2)
# ä¸Šä½10ä»¶ã‚’å¼·èª¿ã—ã¦è¡¨ç¤º
map_osm.add_child(
    folium.features.GeoJson(
        gdf_edges.head(10).to_json(),
        style_function=lambda x: {
            'color': "#FF0000",
            'weight': 7,
            'opacity': (1 - (x['properties']['rank'] - 1) * 0.09)
        }
    )
)
```

![](/images/f9a314841c737d/11.png =500x)

ã•ã‚‰ã«ç›´æ„Ÿçš„ã«ç¢ºèªã™ã‚‹ãŸã‚ã«ã€Google Mapsã‚„ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ç­‰ã®ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚

```diff python
+ # google_map_urlã‚’ä½œæˆ
+ gdf_edges['google_map_url'] = gdf_edges['geometry'].apply(
+     lambda x: f"https://www.google.com/maps/dir/{x.coords[0][1]},{x.coords[0][0]}/'{x.coords[-1][1]},{x.coords[-1][0]}'"
+ )
+ # street_view_urlã‚’ä½œæˆ
+ gdf_edges['street_view_url'] = gdf_edges['geometry'].apply(
+     lambda x: f"https://www.google.com/maps/@{x.coords[0][1]},{x.coords[0][0]},20?layer=c&cbll={x.coords[-1][1]},{x.coords[-1][0]}&cbp=12,0,0,0,0"
+ )
+ # googe_earth_urlã‚’ä½œæˆ
+ def generate_google_earth_url(row):
+     center_index = math.floor(len(row.geometry.coords) / 2) - 1
+     center = row.geometry.coords[center_index]
+     return f"https://earth.google.com/web/search/{center[1]},+{center[0]}"
+ gdf_edges['google_earth_url'] = gdf_edges.apply(generate_google_earth_url, axis=1)

graph = ox.graph_from_gdfs(gdf_nodes, gdf_edges)
# åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹
map_osm = ox.plot_graph_folium(graph, edge_width=2)

# å€™è£œã®ä¸Šä½10ä»¶ã‚’è¡¨ç¤º
map_osm.add_child(
    folium.features.GeoJson(
        gdf_edges.head(10).to_json(),
        style_function=lambda x: {
            'color': "#FF0000",
            'weight': 7,
            'opacity': (1 - (x['properties']['rank'] - 1) * 0.09)
        }
    )
+     # ã‚¨ãƒƒã‚¸ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤ºã™ã‚‹
+     .add_child(folium.features.GeoJsonPopup(
+         fields=['geometory_angle_total', 'length', 'branch_cnt', 'score_normalized', 'google_map_url', 'street_view_url', 'google_earth_url'],
+         aliases=['geometory_angle_total', 'length', 'branch_cnt', 'score_normalized', 'google_map_url', 'street_view_url', 'google_earth_url'],
+         localize=True
+     ))
)
```

![](/images/f9a314841c737d/12.png =500x)
ã“ã‚Œã§ã€æŠ½å‡ºã¨ç¢ºèªãŒè¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## æœªçŸ¥ã®é“ã‚’æŠ½å‡ºã™ã‚‹

ã“ã“ã¾ã§ã¯ã€å°ã•ã„ç¯„å›²ã§è©•ä¾¡é–¢æ•°ã‚’ä½œæˆã—ã¦æŠ½å‡ºã‚’è¡Œã„ã¾ã—ãŸã€‚
æ¬¡ã¯ã€ç¯„å›²ã‚’åºƒã’ã¦`æœªçŸ¥ã®ã€Œæ¥½ã—ã¦é‹è»¢ã§ãã‚‹é“ã€`ã‚’æŠ½å‡ºã—ã¾ã™ã€‚

```diff python
latitude = 35.336452
longitude = 136.922696
+ dist = 10000
- dist = 5000
graph = ox.graph_from_point(center_point=(latitude,longitude),
                            network_type='drive',
                           simplify=True,
                           retain_all=True,
                           dist=dist,
                           custom_filter='["highway"~"secondary|secondary_link|primary|primary_link|trunk|trunk_link"]["lanes"=2]')
```

ã„ã„æ„Ÿã˜ã«æŠ½å‡ºã§ããŸã‚‰å®Œæˆã§ã™ã€‚
![](/images/f9a314841c737d/13.png =500x)

å®Œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã§ã™ã€‚
https://github.com/ritogk/raku-road-searcher

# ãã®ä»–ä½¿ãˆãã†ãªãƒ‡ãƒ¼ã‚¿

https://qiita.com/yH3PO4/items/0a2c84bb860fd7c2d7ae

# ãŠã‚ã‚Šã«

ç´ äººãŒæ‰‹ã‚’å‹•ã‹ã—ã¦å®Ÿè£…ã—ãŸã®ã§ãŠã‹ã—ã„æ‰€ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
ã©ã“ã‹ã®èª°ã‹ã®å‚è€ƒã«ãªã£ãŸã‚‰å¹¸ã„ã§ã™ã€‚
